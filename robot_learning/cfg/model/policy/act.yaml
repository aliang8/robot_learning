name: act_transformer

embedding_model: radio-g
resnet_feature_map_layer: avgpool

# vae encoder # TODO remove this
use_vae: False
kl_weight: 0.001 # vae kl loss weight
latent_dim: 32 # latent distribution parameter space

state_dim: ${env.state_dim}
action_dim: ${env.action_dim}
n_action_steps: 10 # ${data.seq_len}

temporal_agg: True
gaussian_policy: False

net:
  image_obs: ${env.image_obs}
  encoder:
    n_encoder_layers: 3
    dim_model: 512
    n_layers: 3
    n_heads: 4
    dim_feedforward: 2048
    dropout: 0.1
    feedforward_activation: gelu
    pos_enc: learned
    pre_norm: False

  decoder:
    n_decoder_layers: 3
    dim_model: 512
    n_layers: 3
    n_heads: 4
    dim_feedforward: 2048
    dropout: 0.1
    feedforward_activation: gelu
    pos_enc: learned
    pre_norm: False
    is_causal: False

  vae_encoder:
    n_encoder_layers: 3
    dim_model: 512
    n_layers: 3
    n_heads: 4
    dim_feedforward: 2048
    dropout: 0.1
    feedforward_activation: gelu
    pos_enc: learned
    pre_norm: False

  dim_model: 512
  use_vae: ${model.use_vae}
  chunk_size: 10 # ${data.seq_len}
  latent_dim: 32

  embedding_model: ${model.embedding_model}
  resnet_feature_map_layer: ${model.resnet_feature_map_layer}

input_modalities:
  - states
  - external_img_embeds

defaults:
  - policy_base
  - _self_
